---
phase: 01-profile-management-resume-parsing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/profile.ts
  - src/types/resume.ts
  - src/constants/profile-schema.ts
autonomous: true

must_haves:
  truths:
    - "Profile type defines all user data fields from REQ-PRO-01 through REQ-PRO-04"
    - "Type system supports role-specific fields (Tech/Healthcare/Finance)"
    - "Schema validation exists for profile data integrity"
  artifacts:
    - path: "src/types/profile.ts"
      provides: "Complete Profile type with all fields"
      exports: ["Profile", "WorkExperience", "Education", "Skill", "Links", "DomainExtras"]
    - path: "src/types/resume.ts"
      provides: "Resume parsing types and field confidence scoring"
      exports: ["ParsedResume", "FieldConfidence", "ParserResult"]
    - path: "src/constants/profile-schema.ts"
      provides: "Field validation rules and role-specific field definitions"
      exports: ["PROFILE_SCHEMA", "ROLE_SPECIFIC_FIELDS"]
  key_links:
    - from: "src/types/profile.ts"
      to: "src/types/resume.ts"
      via: "ParsedResume matches Profile shape"
      pattern: "Profile.*WorkExperience|Education|Skill"
---

<objective>
Create type-safe foundation for profile management system.

**Purpose:** Define TypeScript types, interfaces, and validation schemas for user profile data, resume parsing results, and role-specific fields before building any parser or UI logic.

**Output:** Complete type system covering all REQ-PRO-01 through REQ-PRO-04 requirements with strict TypeScript validation.
</objective>

<execution_context>
@C:/Users/kittu/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/kittu/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@TECHSTACK.md
@AGENTS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Profile Type System</name>
  <files>src/types/profile.ts</files>
  <action>
Create `src/types/profile.ts` with complete Profile type definition covering all requirements:

**Core Profile Interface:**
```typescript
export type RolePreference = 'Tech' | 'Healthcare' | 'Finance' | 'Marketing' | 'Operations' | 'Other'

export interface PersonalInfo {
  name: string
  email: string
  phone: string
  location: string
  workAuthorization?: string
}

export interface WorkExperience {
  id: string // UUID for list management
  position: string
  company: string
  startDate: string // ISO date
  endDate: string | 'Present'
  achievements: string[] // Bullet points
}

export interface Education {
  id: string
  degree: string
  institution: string
  startDate: string
  endDate: string | 'Present'
  gpa?: string
}

export interface Skill {
  name: string
  category?: string // e.g., "Programming", "Clinical", "Financial"
}

export interface Links {
  linkedin?: string
  github?: string
  portfolio?: string
  personalSite?: string
  other?: Record<string, string>
}

export interface DomainExtras {
  // Tech-specific (REQ-PRO-04)
  techStack?: string[]
  githubUsername?: string
  portfolioUrl?: string
  
  // Healthcare-specific (REQ-PRO-04)
  npiNumber?: string
  clinicalSpecialty?: string
  certifications?: string[]
  licenseNumbers?: string[]
  
  // Finance-specific (REQ-PRO-04)
  finraLicenses?: string[]
  cfaLevel?: string
  cpaLicense?: string
  quantAchievements?: string[]
}

export interface Profile {
  personal: PersonalInfo
  workHistory: WorkExperience[]
  education: Education[]
  skills: Skill[]
  links: Links
  domainExtras: DomainExtras
  rolePreference: RolePreference
  createdAt: string // ISO timestamp
  updatedAt: string // ISO timestamp
}
```

**Helper Types:**
```typescript
export type ProfileSection = keyof Profile
export type RequiredProfileFields = 'personal' | 'rolePreference'
export type OptionalProfileFields = Exclude<ProfileSection, RequiredProfileFields>

// For partial updates
export type ProfileUpdate = Partial<Profile> & {
  updatedAt: string // Always required on updates
}
```

Use JSDoc comments for each field explaining purpose and validation rules.
  </action>
  <verify>
Run `pnpm type-check` - must pass with zero errors.
Verify all REQ-PRO-01 through REQ-PRO-04 fields are represented in types.
  </verify>
  <done>
Profile.ts exports complete type system with Personal, Work, Education, Skills, Links, DomainExtras, and role-specific fields. TypeScript strict mode passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Resume Parsing Types</name>
  <files>src/types/resume.ts</files>
  <action>
Create `src/types/resume.ts` with types for resume parsing flow (REQ-PRO-01):

```typescript
import type { Profile } from './profile'

/**
 * Confidence score for parsed field accuracy
 * ≥70% = high confidence (green highlight)
 * 50-69% = low confidence (yellow highlight, needs review)
 * <50% = very low confidence (red highlight, likely wrong)
 */
export interface FieldConfidence {
  field: string
  confidence: number // 0-100
  source: 'exact-match' | 'pattern-match' | 'heuristic' | 'fallback'
  rawValue?: string // Original text before parsing
}

/**
 * Result of parsing a resume text
 */
export interface ParsedResume {
  profile: Partial<Profile> // May not have all fields
  confidenceScores: FieldConfidence[]
  parseErrors: ParseError[]
  unparsedText: string[] // Sections that couldn't be categorized
}

export interface ParseError {
  section: string
  message: string
  severity: 'warning' | 'error'
}

/**
 * Parser result wrapper with success/failure handling
 */
export type ParserResult<T> = 
  | { success: true; data: T }
  | { success: false; error: string; partialData?: Partial<T> }

/**
 * Resume sections detected during parsing
 */
export enum ResumeSection {
  CONTACT = 'contact',
  SUMMARY = 'summary',
  EXPERIENCE = 'experience',
  EDUCATION = 'education',
  SKILLS = 'skills',
  CERTIFICATIONS = 'certifications',
  PROJECTS = 'projects',
  LINKS = 'links',
  UNKNOWN = 'unknown'
}
```

Include detailed JSDoc comments explaining ≥75% accuracy requirement and confidence thresholds per REQ-PRO-01.
  </action>
  <verify>
Run `pnpm type-check` - must pass.
Verify FieldConfidence supports confidence scoring (REQ-PRO-01 acceptance criteria).
  </verify>
  <done>
Resume parsing types exported with FieldConfidence, ParsedResume, ParserResult. Types support ≥75% accuracy tracking per requirement.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Profile Validation Schema</name>
  <files>src/constants/profile-schema.ts</files>
  <action>
Create `src/constants/profile-schema.ts` with validation rules and role-specific field mappings:

```typescript
import type { RolePreference } from '@/types/profile'

/**
 * Validation rules for profile fields
 */
export const PROFILE_SCHEMA = {
  personal: {
    name: { required: true, minLength: 2, maxLength: 100 },
    email: { required: true, pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/ },
    phone: { required: false, pattern: /^[\d\s\-\+\(\)]+$/, minLength: 10 },
    location: { required: false, maxLength: 200 },
    workAuthorization: { required: false, maxLength: 100 }
  },
  workExperience: {
    position: { required: true, minLength: 2, maxLength: 150 },
    company: { required: true, minLength: 2, maxLength: 150 },
    startDate: { required: true, pattern: /^\d{4}-\d{2}(-\d{2})?$/ },
    endDate: { required: true }, // ISO date or 'Present'
    achievements: { required: false, maxItems: 10 }
  },
  education: {
    degree: { required: true, minLength: 2, maxLength: 150 },
    institution: { required: true, minLength: 2, maxLength: 200 },
    startDate: { required: true },
    endDate: { required: true },
    gpa: { required: false, pattern: /^\d\.\d{1,2}$/ }
  },
  skills: {
    maxCount: 50,
    name: { required: true, minLength: 1, maxLength: 50 }
  }
} as const

/**
 * Role-specific fields visibility (REQ-PRO-04)
 */
export const ROLE_SPECIFIC_FIELDS: Record<RolePreference, string[]> = {
  Tech: ['techStack', 'githubUsername', 'portfolioUrl'],
  Healthcare: ['npiNumber', 'clinicalSpecialty', 'certifications', 'licenseNumbers'],
  Finance: ['finraLicenses', 'cfaLevel', 'cpaLicense', 'quantAchievements'],
  Marketing: [],
  Operations: [],
  Other: []
}

/**
 * Default empty profile structure
 */
export const EMPTY_PROFILE = {
  personal: { name: '', email: '', phone: '', location: '' },
  workHistory: [],
  education: [],
  skills: [],
  links: {},
  domainExtras: {},
  rolePreference: 'Other' as RolePreference,
  createdAt: new Date().toISOString(),
  updatedAt: new Date().toISOString()
} as const

/**
 * Key fields required for ≥75% parse accuracy (REQ-PRO-01)
 */
export const KEY_PARSE_FIELDS = [
  'personal.name',
  'personal.email',
  'personal.phone',
  'workHistory', // At least one entry
  'education', // At least one entry
  'skills' // At least 3 skills
] as const
```

Add JSDoc comments explaining validation logic and role-specific field visibility rules.
  </action>
  <verify>
Run `pnpm type-check` - must pass.
Verify ROLE_SPECIFIC_FIELDS covers Tech/Healthcare/Finance per REQ-PRO-04.
Verify KEY_PARSE_FIELDS matches REQ-PRO-01 acceptance criteria (name, email, phone, work, education, skills).
  </verify>
  <done>
Profile validation schema exported with PROFILE_SCHEMA, ROLE_SPECIFIC_FIELDS, EMPTY_PROFILE, KEY_PARSE_FIELDS. All validation rules defined for Phase 1 requirements.
  </done>
</task>

</tasks>

<verification>
**Type System Verification:**
- [ ] Run `pnpm type-check` - zero TypeScript errors
- [ ] All Profile fields from REQ-PRO-01 through REQ-PRO-04 present in types
- [ ] FieldConfidence supports confidence scoring for parser
- [ ] ROLE_SPECIFIC_FIELDS correctly maps Tech/Healthcare/Finance fields
- [ ] Imports work: `import type { Profile } from '@/types/profile'`

**Requirements Coverage:**
- [ ] REQ-PRO-01: ParsedResume supports ≥75% accuracy tracking
- [ ] REQ-PRO-02: Profile type supports all editor fields
- [ ] REQ-PRO-03: RolePreference type matches requirement options
- [ ] REQ-PRO-04: DomainExtras supports Tech/Healthcare/Finance specific fields
</verification>

<success_criteria>
- Profile type system complete with all required fields
- Resume parsing types support confidence scoring
- Role-specific field mappings defined
- All types pass TypeScript strict mode
- Zero external dependencies added (pure TypeScript)
- Foundation ready for parser implementation (Plan 02) and UI (Plan 03)
</success_criteria>

<output>
After completion, create `.planning/phases/01-profile-management-resume-parsing/01-01-SUMMARY.md` following the standard summary template.
</output>
