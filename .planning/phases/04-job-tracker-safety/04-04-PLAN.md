---
phase: 04-job-tracker-safety
plan: 04
type: execute
wave: 3
depends_on: ["04-01"]
files_modified:
  - src/entrypoints/popup/components/TrackerList.tsx
  - src/entrypoints/popup/components/ApplicationCard.tsx
  - src/entrypoints/popup/components/TrackerFilters.tsx
  - src/entrypoints/popup/App.tsx
  - src/lib/store/tracker-store.ts
autonomous: false

must_haves:
  truths:
    - "User can see all tracked applications in extension popup"
    - "User can filter by status (Applied/Interview/Offer/Rejected/Withdrawn)"
    - "User can filter by ATS platform (Workday/Greenhouse/Lever)"
    - "User can filter by date range"
    - "User can sort by date, company, or status"
    - "User can update application status inline"
    - "User can delete applications"
  artifacts:
    - path: "src/lib/store/tracker-store.ts"
      provides: "Zustand store for tracker UI state"
      exports: ["useTrackerStore"]
      min_lines: 80
    - path: "src/entrypoints/popup/components/TrackerList.tsx"
      provides: "Main tracker list component with sort/filter"
      exports: ["TrackerList"]
      min_lines: 100
    - path: "src/entrypoints/popup/components/ApplicationCard.tsx"
      provides: "Individual application card with status dropdown and delete"
      exports: ["ApplicationCard"]
      min_lines: 60
    - path: "src/entrypoints/popup/components/TrackerFilters.tsx"
      provides: "Filter controls (status, platform, date range)"
      exports: ["TrackerFilters"]
      min_lines: 80
  key_links:
    - from: "src/lib/store/tracker-store.ts"
      to: "chrome.storage.local"
      via: "onChanged listener for real-time sync"
      pattern: "chrome\\.storage\\.onChanged"
    - from: "src/entrypoints/popup/components/TrackerList.tsx"
      to: "src/lib/store/tracker-store.ts"
      via: "useTrackerStore hook"
      pattern: "useTrackerStore\\(\\)"
    - from: "src/entrypoints/popup/components/ApplicationCard.tsx"
      to: "src/lib/tracker/storage.ts"
      via: "updateApplication and deleteApplication calls"
      pattern: "(updateApplication|deleteApplication)\\("
---

<objective>
Build the tracker UI in the extension popup with filtering, sorting, status management, and real-time updates.

**Purpose:** Primary view for users to manage tracked applications - filter, sort, update status, and delete entries.

**Output:** Full-featured tracker interface in popup with Zustand state management and responsive Tailwind styling.
</objective>

<execution_context>
@C:/Users/kittu/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/kittu/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-job-tracker-safety/04-CONTEXT.md
@.planning/phases/04-job-tracker-safety/04-RESEARCH.md
@src/entrypoints/popup/App.tsx
@src/entrypoints/popup/components/
@.planning/phases/01-profile-management/01-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Create Zustand store for tracker UI state</name>
  <files>src/lib/store/tracker-store.ts</files>
  <action>
Create Zustand store for tracker UI state with Chrome Storage sync per 04-RESEARCH.md Zustand Store pattern:

1. **TrackerStore interface** with state:
   - applications: TrackedApplication[]
   - filterStatus: ApplicationStatus | null
   - filterPlatform: ATSPlatform | null
   - filterDateFrom: string | null (ISO date)
   - filterDateTo: string | null (ISO date)
   - sortBy: 'date' | 'company' | 'status'
   - sortOrder: 'asc' | 'desc'

2. **Store actions:**
   - loadApplications(): Promise<void> - loads from Chrome Storage, updates state
   - setFilter(field: 'status' | 'platform' | 'dateFrom' | 'dateTo', value: string | null): void
   - setSorting(by: 'date' | 'company' | 'status', order: 'asc' | 'desc'): void
   - updateApplicationStatus(id: string, status: ApplicationStatus): Promise<void> - calls storage.ts updateApplication, reloads applications
   - removeApplication(id: string): Promise<void> - calls storage.ts deleteApplication, reloads applications

3. **Computed/derived state:**
   - filteredApplications(): TrackedApplication[] - applies all filters and sorting to applications array
   - Logic:
     - Filter by status if filterStatus set
     - Filter by platform if filterPlatform set
     - Filter by date range if filterDateFrom/filterDateTo set
     - Sort by sortBy field in sortOrder direction
     - Return resulting array

4. **Chrome Storage sync:**
   - On store creation, call loadApplications() immediately
   - Set up chrome.storage.onChanged listener:
     - When 'applications' key changes, call loadApplications() to sync UI
     - This enables real-time updates when content script logs new application

5. **Persist middleware:**
   - Use Zustand persist middleware for filter/sort preferences (not applications data)
   - Store key: 'tracker-ui-prefs'
   - Only persist: filterStatus, filterPlatform, sortBy, sortOrder
   - Don't persist applications (those come from Chrome Storage, not Zustand)

Follow pattern from 04-RESEARCH.md. Export useTrackerStore hook. Use Zustand 5.0.11 (already in stack).
  </action>
  <verify>
Run unit tests: `pnpm test src/lib/store/tracker-store.test.ts`
Tests must verify: filtering logic, sorting logic, Chrome Storage sync.
Manual check: `pnpm type-check` passes.
  </verify>
  <done>
Zustand store created with filtering, sorting, and Chrome Storage sync. Real-time updates working when applications added via content script. Filter/sort preferences persisted across popup opens.
  </done>
</task>

<task type="auto">
  <name>Build ApplicationCard component</name>
  <files>src/entrypoints/popup/components/ApplicationCard.tsx</files>
  <action>
Create individual application card component:

1. **Props interface:**
   - application: TrackedApplication
   - onStatusChange: (id: string, status: ApplicationStatus) => void
   - onDelete: (id: string) => void

2. **Card layout (Tailwind CSS):**
   - Compact card design optimized for popup width (400px)
   - Information density per CONTEXT.md Claude's Discretion: show job title, company, ATS platform, date, status at a glance
   - Layout:
     - Top row: Job title (bold, truncate long titles)
     - Second row: Company name + ATS platform badge
     - Third row: Applied date (relative: "2 days ago" or absolute: "Mar 1, 2026")
     - Fourth row: Status dropdown + Delete button

3. **Status dropdown:**
   - Select element with ApplicationStatus options: Applied, Interview, Offer, Rejected, Withdrawn
   - Current status selected by default
   - On change: call onStatusChange(application.id, newStatus)
   - Inline editing (no separate edit mode)

4. **Delete button:**
   - Small icon button (trash icon or "×")
   - On click: show confirmation dialog "Delete this application?"
   - If confirmed: call onDelete(application.id)
   - Use window.confirm() for simplicity (or custom modal if time permits)

5. **Visual design:**
   - Card background: white with subtle border
   - Hover state: slight shadow lift
   - Status badge colors:
     - Applied: blue
     - Interview: yellow
     - Offer: green
     - Rejected: red
     - Withdrawn: gray
   - ATS platform badge: small pill with platform name

Follow existing popup component patterns from Phase 1 (profile editor). Use Tailwind CSS 4.2.0 for styling. Responsive within popup constraints.
  </action>
  <verify>
Manual test in popup: Display application card → verify all fields visible, status dropdown works, delete button shows confirmation.
Check responsive behavior: resize popup → verify card adapts without horizontal scroll.
  </verify>
  <done>
ApplicationCard component displays all application metadata in compact format. Status can be updated inline. Delete confirmation prevents accidental deletions. Styling uses Tailwind with status-specific colors.
  </done>
</task>

<task type="auto">
  <name>Build TrackerFilters component</name>
  <files>src/entrypoints/popup/components/TrackerFilters.tsx</files>
  <action>
Create filter controls component for multi-criteria filtering per CONTEXT.md (status + platform + date range):

1. **Filter controls:**
   - **Status filter:** Dropdown with options: All, Applied, Interview, Offer, Rejected, Withdrawn
   - **Platform filter:** Dropdown with options: All, Workday, Greenhouse, Lever, Unknown
   - **Date range filter:** Two date inputs (from/to) or preset ranges: Today, Last 7 days, Last 30 days, All time

2. **Layout:**
   - Horizontal row with 3 dropdowns (or 2 rows if space tight)
   - Clear filters button (resets all to default)
   - Compact design to fit in popup width

3. **State management:**
   - Use useTrackerStore to get/set filter values
   - On dropdown change: call store.setFilter(field, value)
   - Store handles actual filtering logic (computed filteredApplications)

4. **Sorting controls:**
   - Sort by dropdown: Date, Company, Status
   - Sort order toggle: Asc/Desc (or ↑/↓ icon button)
   - On change: call store.setSorting(by, order)

5. **Visual design:**
   - Small, space-efficient dropdowns
   - Icons for sort direction (↑↓)
   - Clear/Reset button visible when filters active (gray out when all filters at default)

Use Tailwind select styling. Follow existing form component patterns from Phase 1. Export TrackerFilters component.
  </action>
  <verify>
Manual test: Change filters → verify TrackerList re-renders with filtered results
Toggle sort order → verify list reorders
Clear filters → verify list shows all applications
  </verify>
  <done>
TrackerFilters component provides multi-criteria filtering (status + platform + date range) and sorting controls. Filters sync with Zustand store. Clear button resets all filters.
  </done>
</task>

<task type="auto">
  <name>Build TrackerList component and integrate into popup</name>
  <files>
src/entrypoints/popup/components/TrackerList.tsx
src/entrypoints/popup/App.tsx
  </files>
  <action>
Create main tracker list component and integrate into popup:

**TrackerList.tsx:**

1. **Use Zustand store:**
   - const { filteredApplications, updateApplicationStatus, removeApplication, loadApplications } = useTrackerStore()
   - useEffect hook to call loadApplications() on mount

2. **Render TrackerFilters component** at top

3. **Render list of ApplicationCard components:**
   - Map over filteredApplications
   - Pass onStatusChange={updateApplicationStatus} and onDelete={removeApplication}
   - Show count: "{filteredApplications.length} applications"

4. **Empty state:**
   - If filteredApplications.length === 0 and no filters active:
     - Show message: "No applications tracked yet. Apply to a job to see it here!"
   - If filteredApplications.length === 0 but filters active:
     - Show message: "No applications match your filters. Try adjusting filters."

5. **Loading state:**
   - Show skeleton/spinner while applications loading (initial mount)

**App.tsx integration:**

1. **Add "Tracker" tab** (if not already present):
   - Tab navigation: Profile | Tracker | Settings
   - Default tab: Tracker (per CONTEXT.md - tracker is primary view)

2. **Route to TrackerList component** when Tracker tab active

3. **Tab state:**
   - Use useState for active tab or existing routing from Phase 1
   - Persist active tab in localStorage (optional)

Follow existing popup layout from Phase 1/2/3. Use Tailwind for responsive grid. Ensure popup scrolls if many applications.
  </action>
  <verify>
**Checkpoint: Human visual verification required**
</verify>
  <done>
TrackerList component displays filtered/sorted applications. Integrated into popup as primary "Tracker" tab. Empty states handle no data and no results scenarios. Loading state during initial data fetch.
  </done>
</task>

</tasks>

<verification>
**Checkpoint: Manual visual and functional verification**

This plan includes a checkpoint because UI requires human verification.

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete tracker UI in extension popup with filtering, sorting, status updates, and delete functionality.

Components created:
- TrackerFilters: Multi-criteria filters (status, platform, date range) + sorting controls
- ApplicationCard: Individual application display with inline status dropdown and delete button
- TrackerList: Main list view with empty states
- Zustand store: tracker-store.ts with Chrome Storage sync
  </what-built>
  
  <how-to-verify>
**Step 1: Load popup and verify layout**
1. Open extension popup (click extension icon)
2. Navigate to "Tracker" tab (should be default view)
3. Verify layout is clean and fits within popup width (400px)
4. Check that filters are visible at top (Status, Platform, Date range, Sort)

**Step 2: Test empty state**
1. If no applications, verify empty state message shows: "No applications tracked yet..."
2. Apply to a test job (use Phase 2 autofill or manual submission)
3. Verify application appears in tracker list within a few seconds (real-time sync)

**Step 3: Test filtering**
1. Add multiple test applications with different statuses and platforms
2. Filter by status "Interview" → verify only Interview applications show
3. Filter by platform "Workday" → verify only Workday applications show
4. Clear filters → verify all applications show again
5. Set date range to "Last 7 days" → verify only recent applications show

**Step 4: Test sorting**
1. Sort by Date (descending) → verify newest applications at top
2. Toggle to ascending → verify oldest at top
3. Sort by Company → verify alphabetical order
4. Sort by Status → verify grouped by status

**Step 5: Test status updates**
1. Click status dropdown on an application
2. Change from "Applied" to "Interview"
3. Verify status updates immediately (no page reload needed)
4. Check Chrome Storage in DevTools → verify status persisted

**Step 6: Test delete**
1. Click delete button (trash icon or "×") on an application
2. Verify confirmation dialog appears: "Delete this application?"
3. Cancel → verify application still present
4. Click delete again, confirm → verify application removed from list
5. Check Chrome Storage → verify deleted from storage

**Step 7: Test responsive behavior**
1. Resize popup (if possible) or test on different screen DPIs
2. Verify no horizontal scroll
3. Verify cards stack vertically
4. Verify text truncates properly (long job titles/company names)

**Step 8: Test real-time sync**
1. Open popup in one window
2. Submit application in another tab (trigger content script logging)
3. Verify new application appears in popup without manual refresh
4. This tests chrome.storage.onChanged listener

**Expected visual design:**
- Clean card-based layout with subtle shadows
- Status badges with appropriate colors (blue/yellow/green/red/gray)
- ATS platform badges visible
- Filters compact and usable
- No visual bugs (overlapping text, broken layout)
  </how-to-verify>
  
  <resume-signal>
After completing manual verification, type "approved" if all tests pass, or describe any issues found for revision.
  </resume-signal>
</task>

**Automated verification:**

Run unit tests: `pnpm test src/lib/store/tracker-store.test.ts`
Run type check: `pnpm type-check`
Check component renders: `pnpm test src/entrypoints/popup/components/` (if component tests exist)
</verification>

<success_criteria>
**Phase 4 Plan 04 complete when:**

- [ ] src/lib/store/tracker-store.ts implements filtering, sorting, and Chrome Storage sync
- [ ] ApplicationCard component displays all application metadata compactly
- [ ] TrackerFilters component provides multi-criteria filtering
- [ ] TrackerList component integrates filters + cards
- [ ] Tracker tab integrated into popup as primary view
- [ ] Status updates work inline (dropdown selection persists)
- [ ] Delete functionality works with confirmation
- [ ] Real-time sync working (new applications appear without refresh)
- [ ] Empty states display appropriately
- [ ] Manual visual verification passed (human checkpoint)
- [ ] Unit tests pass for tracker-store.ts
- [ ] No TypeScript errors: `pnpm type-check` passes
- [ ] Git commit created: `feat(04-04): implement tracker UI with filtering and sorting`
</success_criteria>

<output>
After completion, create `.planning/phases/04-job-tracker-safety/04-04-SUMMARY.md` with:
- UI layout decisions (card-based vs table)
- Filter/sort implementation approach
- Real-time sync behavior (Chrome Storage onChange listener)
- Visual design choices (colors, spacing, responsiveness)
- Checkpoint verification results
- Any UX issues discovered and how resolved
</output>
